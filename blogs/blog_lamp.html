<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LED Towhook Project</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            background-color: #a6a6a6;
            padding: 40px;
            color: #333;
        }
        .content {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #1f4037;
        }
        h2 {
            font-size: 28px;
            margin-top: 40px;
            border-bottom: 2px solid #1f4037;
            padding-bottom: 10px;
        }
        h3 {
            font-size: 22px;
            margin-top: 30px;
            color: #1f4037;
        }
        p {
            font-size: 18px;
            line-height: 1.8;
            color: #555;
            margin-bottom: 20px;
        }
        ul, ol {
            margin-bottom: 20px;
        }
        .toc {
            background: #f4f4f4;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc a {
            text-decoration: none;
            color: #1f4037;
            font-weight: bold;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-top: 20px;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 20px;
            background: #1f4037;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s ease-in-out;
        }
        .back-link:hover {
            background: #99f2c8;
        }
    </style>
</head>
<body>
    <div class="content">
        <h1>STM32-Based RGB Led Lamp</h1>
        <nav class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#project-overview">Project Overview</a></li>
                <li><a href="#designing-the-pcb">Designing the PCB</a></li>
                <li><a href="#programming-firmware">Programming the Firmware</a></li>
                <li><a href="#future-improvements">Future Improvements</a></li>
                <li><a href="#conclusion">Conclusion</a></li>
            </ul>
        </nav>
        <section id="introduction">
            <h2>Introduction</h2>
            <p>Can a lamp be fashionable? An interior designer would say so. This lamp definitely isn't. The cool thing is that it CAN be. I'm going to be introducing what I consider a pretty neat product. Similar to 
                my previous project, the LED Tow Hitch, this lamp takes advantage of magnets to allow a user to swap designs based on their personality, mood, season, etc. Even better, because this is a lamp meant to accessorize
                your desk or a shelf, we are able to integrate powerful RGB leds and a microcontroller, allowing for some pretty fun effects. 
            </p>
            <img src="../images/images_lamp/lamp_dodger.JPG" alt="Dodger Lamp">
            <video width="640" height="360" controls>
                <source src="../images/images_lamp/video_lamp.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </section>
        <section id="project-overview">
            <h2>Project Overview</h2>
            <p>This Project Consists of 3 Main Components:</p>
            <ul>
                <li><strong>LED PCB:</strong> We will need to create a compact board that can fit within the lamp housing</li>
                <li><strong>Firmware</strong> We will need to create firmware that will run on the microcontroller for the LED effects</li>
                <li><strong>3D Printed, Modular, Enclosure:</strong> We will need a stylish enclosure that can protect the PCB and easily swap designs</li>
            </ul>
        </section>
        <section id="#designing-the-pcb">
            <h2>Power</h2>
            <p>Before starting a design I like to imagine how I want the product to be powered. A battery? USB? In this lamp's case, I imagined myself wanting to plug it into an outlet near my desk. Or an outet below where
                I hung it up. With this in mind, I have had great experiences using AC/DC wall plugs. They are cheap, plentiful on Amazon, and they are sold in a wideeee variety of voltages and, more importantly, amp ratings.
                In addition to the how it will be powered, 'what' voltage it will be powered at is just as important. When first starting this project I envisioned myself taking the MCU/power electronics accross projects so I went
                with a 12V input that will allow me to power higher voltage components if needed and step-down anything else for the lower voltage electronics.
            </p>
            <img src="../images/images_lamp/wall_wart.png" alt="Wall Wart">
            <h2>RGB LEDs</h2>
            <p>RGB LEDs are everywhere and very easy to find. However, I was looking at JLCPCB to do the assembly of this board for me. This, once again, meant I was a bit limited in the components I could pick. Even moreso for the LEDs
                because JLCPCB decided to designate many of these as 'Extended Parts' ($) AND as 'Standard' parts ($$$). To narrow down my choices, I knew I wanted an RGB LED with a built-in IC. This means I won't have to worry about
                managing current like I had to with the tow hitch cover. I also didn't need any high current LEDs as those tend to be more work, especially if they require a heat sink. This narrowed down my choices significantly and I settled on
                SK6812 series LED. This one in particular was a 'mini'; I appreciated the smaller footprint.
            </p>
            <h2>Microcontroller</h2>
            <p>For the microcontroller, I knew I was going to go with an MCU from ST's line-up. This is mainly because I am very familiar with their microcontroller and tools. Since the SK6812 LEDs require PWM it was clear I would, at a minimum,
                need the MCU to have some on-board timers. I settled on ST's STM32G0F6. This is considered ST's 'Budget Line'. The G0 has basic peripherals like I2C, SPI, UART, and a speedy enough 64Mhz clock. This was more than enough for my application
                and future applications. In hindsite, the F6 in particular (once taking into account an external clock, SWD Wire, Reset Wire, etc.) runs out of pins really quick. It makes a great application-specific MCU, but if you are looking for upgradability,
                I would get a higher pin package. Additionally, the low RAM and Flash size(32K/8K) will have you making sure every variable and line of code in your firmware needs to be there.
            </p>
            <h2>What Else?</h2>
            <p>Given these components we have a few power requirements:</p>
            <img src="../images/images_lamp/wall_wart.png" alt="Wall Wart">
        </section>
        <section id="future-improvements">
            <h2>Future Improvements</h2>
            <p>The 3D printed design is very solid but there are a few improvements that can be made on the PCB side:</p>
            <ul>
                <li> Wider power traces! </li>
                <li> Better component placement. Currently, some spots on the board are very cool and some portions have hotspots </li>
                <li> Larger current limiting resistor value. Currently, some resistors are wired in-line with the 4-pin harness to lower the 25mA forward current.
                    This isn't ideal and we can easily change our current limiting resistor equation to 15-20mA after our real-world testing.
                    This means increasing our 160 Ohm resistance to anywhere from 200-260 Ohms.
                </li>
                <li>
                    Ambient Derating! This still isn't exactly where I would like it to be at, especially for an automotive application in California. We get up to 110F
                    days in the summer. However, I want to note that because our 4 pin connector only relies on DRLs (auto DRL are usually not on during the day), chances are the board will be on mostly at night (meaning it is cooler).
                </li>
            </ul>
        </section>
        <section id="conclusion">
            <h2>Conclusion</h2>
            <p>After all is said and done, we get a cool, robust, tow hook cover that lights up!</p>
            <video width="640" height="360" controls>
                <source src="../images/images_towhook/towhook_ex.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>

            <h3>V3 Has Been Created!</h3>
            <p>Features:</p>
            <ul>
                <li>Lower current driving the LEDs</li>
                <li>Consolidated & larger (value, not package) resistors. Down from 24 resistors to 12.</li>
                <li>Wider traces! Better utilization and heat distribution through out the board.</li>
            </ul>
            <img src="../images/images_towhook/pcb_design_v3.png" alt="PCB V3">
        </section>
    </div>
</body>
</html>
